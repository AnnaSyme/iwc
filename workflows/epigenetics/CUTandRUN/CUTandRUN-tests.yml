- doc: Test outline for CUTandRUN
  job:
    PE fastq input:
      class: Collection
      collection_type: list:paired
      elements:
      - class: Collection
        type: paired
        identifier: Rep1
        elements:
        - identifier: forward
          class: File
          location: https://zenodo.org/record/6823059/files/Rep1_R1.fastq
          filetype: fastqsanger
        - identifier: reverse
          class: File
          location: https://zenodo.org/record/6823059/files/Rep1_R2.fastq
          filetype: fastqsanger
    adapter_forward: 'GATCGGAAGAGCACACGTCTGAACTCCAGTCAC'
    adapter_reverse: 'GATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'
    reference_genome: 'hg38canon'
    effective_genome_size: 2700000000
  outputs:
    Mapping stats:
      element_tests:
        Rep1:
          asserts:
            has_text:
              text: "289103 reads; of these:"
            has_text_matching:
              expression: "99.39% overall alignment rate"
    BAM filtered rmDup:
      element_tests:
        Rep1:
          asserts:
            has_size:
              value: 10914132
              delta: 1000000
    MarkDuplicates metrics:
      element_tests:
        Rep1:
          asserts:
            has_text:
              text: "0.33"
    MACS2 summits:
      element_tests:
        Rep1:
          has_n_lines:
            n: 1856
    MACS2 narrowPeak:
      element_tests:
        Rep1:
          has_n_lines:
            n: 1856
    MACS2 peaks xls:
      element_tests:
        Rep1:
          asserts:
            has_text:
              text: "# tag size is determined as 40 bps"
            has_text_matching:
              expression: "# total tags in treatment: 360634"
    Coverage from MACS2 (bigwig):
      element_tests:
        Rep1:
          asserts:
            has_size:
              value: 1832128
              delta: 100000