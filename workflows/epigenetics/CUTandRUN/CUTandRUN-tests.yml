- doc: Test outline for CUTandRUN
  job:
    PE fastq input:
      class: Collection
      collection_type: list:paired
      elements:
      - class: Collection
        type: paired
        identifier: Rep1
        elements:
        - identifier: forward
          class: File
          location: https://usegalaxy.org/api/datasets/f9cad7b01a472135cb11b709095a67a5/display?to_ext=fastqsanger.gz
          filetype: fastqsanger
        - identifier: reverse
          class: File
          location: https://usegalaxy.org/api/datasets/f9cad7b01a4721353bb83bfcf4b17773/display?to_ext=fastqsanger.gz
          filetype: fastqsanger
    adapter_forward: 'GATCGGAAGAGCACACGTCTGAACTCCAGTCAC'
    adapter_reverse: 'GATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'
    reference_genome: 'dm6'
    effective_genome_size: 120000000
  outputs:
    Mapping stats:
      element_tests:
        Rep1:
          asserts:
            has_text:
              text: "3438486 reads; of these:"
            has_text_matching:
              expression: "98.15% overall alignment rate"
    BAM filtered rmDup:
      element_tests:
        Rep1:
          asserts:
            has_size:
              value: 161194630
              delta: 10000000
    MarkDuplicates metrics:
      element_tests:
        Rep1:
          asserts:
            has_text:
              text: "0.012849"
    MACS2 summits:
      element_tests:
        Rep1:
          has_n_lines:
            n: 16478
    MACS2 narrowPeak:
      element_tests:
        Rep1:
          has_n_lines:
            n: 16478
    MACS2 peaks xls:
      element_tests:
        Rep1:
          asserts:
            has_text:
              text: "# tag size is determined as 36 bps"
            has_text_matching:
              expression: "# total tags in treatment: 4915718"
    Coverage from MACS2 (bigwig):
      element_tests:
        Rep1:
          asserts:
            has_size:
              value: 39091585
              delta: 4000000
